# Домашнее задание к Лекции 1 Network
## 1. Разделить 192.168.0.0/24 на две сети, чтобы в каждой было не менее 127 адресов.

Для деления сети 192.168.0.0/24 необходимо использовать маску /25, которая даёт 2^7 = 128 адресов в каждой подсети:

| Параметр | Первая подсеть | Вторая подсеть |
|----------|----------------|----------------|
| Адрес сети | 192.168.0.0/25 | 192.168.0.128/25 |
| Маска | 255.255.255.128 | 255.255.255.128 |
| Диапазон IP | 192.168.0.1-126 | 192.168.0.129-254 |
| Адрес сети (не используется) | 192.168.0.0 | 192.168.0.128 |
| Широковещательный адрес | 192.168.0.127 | 192.168.0.255 |
| Количество доступных адресов | 126 (128-2) | 126 (128-2) |

Таким образом, каждая подсеть содержит 128 адресов (включая адрес сети и широковещательный).

## 2. В чем разница "белых" и "серых" ip адресов?

| Характеристика | "Белые" (публичные) IP-адреса | "Серые" (приватные) IP-адреса |
|----------------|-------------------------------|--------------------------------|
| Уникальность | Глобально уникальны в интернете | Уникальны только внутри локальной сети |
| Назначение | Провайдерами или регистраторами | Администратором локальной сети |
| Маршрутизация | Маршрутизируются в интернете | Не маршрутизируются в интернете |
| Стоимость | Обычно платные | Бесплатные |
| Доступность | Напрямую доступны из интернета | Требуют NAT для доступа в интернет |
| Примеры использования | Веб-серверы, почтовые серверы | Домашние компьютеры, принтеры в офисе |
| Примеры | 51.50.20.67, 8.8.8.8 | 192.168.1.100, 10.0.0.5 |
| Диапазоны | Все, кроме зарезервированных для частных сетей | 10.0.0.0–10.255.255.255 (10.0.0.0/8) 172.16.0.0–172.31.255.255 (172.16.0.0/12) 192.168.0.0–192.168.255.255 (192.168.0.0/16) |

**NAT (Network Address Translation)** - технология преобразования частных IP в публичные для выхода в интернет. Например, роутер транслирует запросы всех домашних устройств через один белый IP-адрес.

## 3. В чем принципиальная разница UDP и TCP?

| Характеристика | TCP (Transmission Control Protocol) | UDP (User Datagram Protocol) |
|----------------|-------------------------------------|------------------------------|
| Тип соединения | С установкой соединения (connection-oriented) | Без установки соединения (connectionless) |
| Надежность | Гарантирует доставку данных | Не гарантирует доставку |
| Порядок пакетов | Гарантирует получение данных в правильном порядке | Пакеты могут приходить в произвольном порядке |
| Подтверждение доставки | Использует подтверждения (ACK) | Нет подтверждений |
| Контроль потока | Регулирует скорость для предотвращения перегрузки | Отправляет данные с максимальной скоростью |
| Размер заголовка | 20-60 байт | 8 байт |
| Название пакетов | Сегменты | Датаграммы |
| Установка соединения | "Трехстороннее рукопожатие" (SYN, SYN-ACK, ACK) | Отсутствует |
| Производительность | Медленнее из-за дополнительных проверок | Быстрее из-за отсутствия проверок |
| Примеры использования | Web (HTTP/HTTPS), Email (SMTP), FTP | Стриминг видео, онлайн-игры, VoIP, DNS |

## 4. Какой командой можно посмотреть все правила iptables?

Основная команда для просмотра всех правил iptables:

```bash
sudo iptables -L -v -n
```

где:
- `-L` (--list) — вывести список правил
- `-v` (--verbose) — подробный вывод (включая счетчики пакетов/байтов)
- `-n` (--numeric) — отображать IP-адреса и порты в числовом формате без преобразования в имена

Дополнительные варианты:

| Команда | Описание |
|---------|----------|
| `sudo iptables -S` | Вывод правил в формате, пригодном для использования в скриптах |
| `sudo iptables -t nat -L -v` | Просмотр правил в конкретной таблице (например, nat) |
| `sudo iptables -L INPUT` | Просмотр правил только для цепочки INPUT |
| `sudo iptables -L --line-numbers` | Вывод правил с номерами строк |
| `sudo iptables-save` | Сохранение всех правил в формате, пригодном для восстановления |

Для просмотра правил во всех таблицах:
```bash
for table in filter nat mangle raw; do echo "Table $table"; sudo iptables -t $table -L -v; echo; done
```

## 5. В чем разница режимов --network bridge и --network host в работе сети контейнеров?

| Параметр | --network bridge | --network host |
|----------|------------------|----------------|
| Сетевой стек | Изолированный | Общий с хост-системой |
| IP-адресация | Контейнер получает свой IP в виртуальной сети | Использует IP-адрес хоста |
| Проброс портов | Требуется явный проброс портов (`-p 80:80`) | Не требуется, порты доступны напрямую |
| Производительность | Имеет небольшие накладные расходы на NAT | Максимальная (отсутствие виртуализации сети) |
| Безопасность | Выше (изоляция контейнеров) | Ниже (прямой доступ к сетевому стеку хоста) |
| Конфликты портов | Можно запускать несколько сервисов на одном порту (в разных контейнерах) | Невозможно использовать один порт для нескольких контейнеров |
| DNS | Автоматическое разрешение имён контейнеров | Использует DNS-настройки хоста |
| Типичные применения | Большинство приложений, требующих изоляции | Высоконагруженные приложения, требующие минимальной задержки |

**Пример команд:**

Bridge:
```bash
docker network create my_bridge
docker run --network=my_bridge -p 80:80 -d nginx
```

Host:
```bash
docker run --network=host -d nginx
```

## 6. Какой командой можно проверить доступность хоста при помощи протокола icmp?

Основная команда для проверки доступности хоста по ICMP:

```bash
ping <имя_хоста_или_IP-адрес>
```

**ICMP (Internet Control Message Protocol)** — протокол для диагностики сети, который передает сообщения об ошибках и информационные сообщения.

Доп опции для команды ping:

| Опция | Описание | Пример |
|-------|----------|--------|
| `-c` | Указать количество отправляемых пакетов | `ping -c 4 192.168.1.1` |
| `-i` | Интервал между пакетами (в секундах) | `ping -i 2 192.168.1.1` |
| `-s` | Установить размер пакета в байтах | `ping -s 1500 192.168.1.1` |
| `-t` | Установить значение TTL | `ping -t 64 192.168.1.1` |
| `-W` | Таймаут ожидания ответа (в секундах) | `ping -W 5 192.168.1.1` |

Пример вывода:
```
64 bytes from 192.168.1.1: icmp_seq=1 ttl=64 time=1.23 ms
64 bytes from 192.168.1.1: icmp_seq=2 ttl=64 time=1.15 ms
64 bytes from 192.168.1.1: icmp_seq=3 ttl=64 time=1.18 ms
64 bytes from 192.168.1.1: icmp_seq=4 ttl=64 time=1.20 ms

--- 192.168.1.1 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3004ms
rtt min/avg/max/mdev = 1.150/1.190/1.230/0.034 ms
```

## 7. При использовании команды ip как можно посмотреть маршрут по умолчанию (default gateway) и список других маршрутов на вашем хосте?

Основная команда для просмотра маршрутов:

```bash
ip route show
```

или сокращённо:

```bash
ip r
```

**Маршрут по умолчанию (default gateway)** — узел, через который отправляются пакеты, предназначенные для сетей, не имеющих явного маршрута в таблице маршрутизации.

Доп команды:

| Команда | Описание |
|---------|----------|
| `ip route show default` | Показать только маршрут по умолчанию |
| `ip route show table all` | Показать маршруты во всех таблицах маршрутизации |
| `ip -s route show` | Показать статистику маршрутов |
| `ip route get 8.8.8.8` | Показать, через какой интерфейс пойдёт пакет к указанному IP |

Пример вывода `ip route show`:
```
default via 192.168.1.1 dev eth0 proto static metric 100
192.168.1.0/24 dev eth0 proto kernel scope link src 192.168.1.100 metric 100
10.0.0.0/8 via 192.168.1.254 dev eth0 proto static metric 100
```

Где:
- `default via 192.168.1.1` — маршрут по умолчанию (шлюз) через IP 192.168.1.1
- `dev eth0` — интерфейс, через который доступен маршрут
- `proto static/kernel` — источник маршрута (static = ручная настройка, kernel = автоматически)
- `metric 100` — метрика маршрута (приоритет, меньше = выше)

## 8. Как при помощи команды nmap можно проверить доступность портов на хосте 192.168.10.12 для TCP 443 порт, для UDP 3389

Для проверки TCP порта 443:
```bash
nmap -p 443 -Pn 192.168.10.12 (Добавил -Pn так как хост не пинговался)
```

Для проверки UDP порта 3389:
```bash
sudo nmap -sU -p 3389 -Pn 192.168.10.12
```

Для проверки обоих портов одновременно:
```bash
nmap -p T:443,U:3389 192.168.10.12
```

| Ключ | Описание |
|------|----------|
| `-p` | Указывает конкретные порты для сканирования |
| `-sU` | Сканирование UDP-портов (по умолчанию nmap сканирует только TCP) |
| `-sS` | SYN-сканирование (быстрое, не завершает соединение) |
| `-sV` | Определение версии служб на открытых портах |
| `-v` | Подробный вывод |
| `--reason` | Показывает причину определения состояния порта |

Результаты сканирования могут показать следующие статусы портов:
- `open` — порт открыт и доступен
- `closed` — порт закрыт (служба не запущена)
- `filtered` — порт заблокирован фаерволом или другими средствами
- `open|filtered` — nmap не может определить, открыт порт или фильтруется (часто для UDP)

Пример вывода:
```
Starting Nmap 7.93 ( https://nmap.org ) at 2025-05-19 12:00 UTC
Nmap scan report for 192.168.10.12
Host is up (0.002s latency).

PORT    STATE SERVICE
443/tcp open  https

Nmap done: 1 IP address (1 host up) scanned in 0.15 seconds
```